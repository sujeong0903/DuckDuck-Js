# 어덕편덕

* 웨일 확장앱 공모전 참가작

# 추가해야할 기능 & 수정해야할 것
* 이미지 중복 처리 (수정)

# 인수인계 사항
### - 현재 진행 상황 (2018.11.26)
#### 0. 서버에 파이썬 모듈 업로드 완료 (파이썬 모듈 실행시 json문자열을 결과값으로 받습니다.)
#### 1. 이미지 다운로드시 신뢰도가 60%이하면 사용자에게 이대로 저장할 것인지 수정할 것인지 알림
#### 2. 사용자에게 파일 이름을 받는 경우 파일이름에 null값을 입력해버리면 원본이름으로 정리 (그외에 파일명으로 사용할 수 없는 문자 ex> .,?,! 등 처리해주어야함. - 면접 다녀와서 수정할게요!)
#### 2-1. 파일명에 특수문자시 다시 입력을 입력하도록 수정 2018.11.29(jeong) prompt에서 약 7초 이내로 변경하지 않을 경우 원본으로 저장한다는 창 노출됨. 수정필요!)
#### 3. 인물 여러명 인식시 알림 여부는 체크박스로 처리 (UI 수정 부탁해요. 지은짱!)
#### 4. 인물 여러명 일때는 각 인물 이름과 신뢰도 목록으로 보여주고 기본 파일이름값으로는 신뢰도가 가장 높은 인물을 줌
#### 5. 이미지 파일이 아닌 경우 또는 서버 모듈 장애(대부분 네트워크 문제)인 경우 원본이름으로 저장할지 알림
#### 6. 서비스 on, 이미지 처리 중일 때 icon 배지 추가
#### 7. 단축키 추가 Alt+S : 서비스 on/off, Alt+A : 사이드바 on/off
#### 8.분석 notification 추가
#### 9. download.search 웨일 api 호출시 시간이 걸려 순서가 안맞는 문제 발생. 수정필요! (2018.11.29 jeong)


**대부분의 오류는 try-catch로 처리해서 수정되었으나 혹시 발견하는 오류가 있으면 알려주세요!**



-----------------------------------------------------------------
(작성중)

어떻게 사용하나요?

1. 웨일 확장앱에서 어덕편덕을 다운로드 받으시면, 사이드바에 아이콘이 나타납니다.

2. 사이드바앱에서는 각종 설정, 가장 최근에 다운로드 받은 이미지의 정보 및 이전 다운로드 기록을 확인할 수 있습니다. (단축키 Alt+A)

3. 사이드바앱의 오른쪽 상단에 있는 스위치로 서비스를 키고 끌 수 있습니다. (단축키 Alt+S)

4. 웹에서 원하시는 이미지에서 마우스 오른쪽을 클릭하고 '이미지 저장'을 클릭하세요.
('다른 이름으로 저장' 클릭시 정상적으로 경로가 지정되지 않을 수도 있습니다.)

5. 덕덕이가 열심히 이미지를 분석합니다.

6. 덕덕이가 분석한 인물 신뢰도가 60% 이상인 경우 바로 사용자 컴퓨터의 '다운로드-인물이름'폴더로 저장됩니다.
   (다운로드 기록은 사이드바앱에서 확인할 수 있어요.)

7. 분석한 신뢰도가 60%이하인 경우 사용자가 직접 파일 이름을 입력할 수 있습니다.

8. '인물이 여러명 인식된 경우 알림'이 체크되어 있는 경우, 이미지 저장시 2명 이상 인식 되면 사용자가 직접 파일 이름을 입력할 수 있습니다. (체크 해제된 경우에는 가장 신뢰도가 높은 인물을 기준으로 저장합니다.)

9. 기타 문의 사항이나 오류는 FAQ 탭을 참고해주세요.

FAQ. (최종 업데이트 2018.11.25)

Q. 인물이 다른 이름으로 저장돼요.
A. 어덕편덕은 네이버 클로버의 유명인 인식 서비스로부터 분석 결과를 받아옵니다. 인물 사진의 분석 결과는 어덕편덕 사이드바앱의 다운로드 로그에서 확인하실 수 있습니다. 분석 결과가 정확하지 않은 경우 Clova Face Recognition API의 개발자 포럼으로 문의주세요.

Q. 사진 저장 경로가 '다운로드-인물 폴더'가 아니에요.
A. 이미지에서 마우스 오른쪽 클릭 후 '다른 이름으로 저장'을 클릭하는 경우 경로가 제대로 지정되지 않습니다. 대신, '이미지 저장'을 클릭해주세요.

Q. 계속 '인물 사진 처리에 실패했습니다' 경고창이 나타나요.
A. 네트워크 상태가 불안정한 경우 인물 사진 처리가 원할하지 않을 수 있습니다. 네트워크 상태를 확인해주세요. 네트워크 상태가 안정적이지만 해당 경고창이 지속적으로 나타난다면, 개발자 연락처로 문의주세요.

Q. 제가 다운로드 받은 사진이 서버에 저장되나요?
A. 인물 인식 처리를 위해 임시 파일로 저장되지만, 일정 시간 이후 자동으로 삭제되며 기록을 남기지 않습니다.

Q.

-----------------------------------------------------------------
서버 파일 수정
#73 line 
#용량이 2MB 이상이면 크기 줄이기 (gif가 아닌 경우는 크기를 줄이고, gif이면 저장 확장자를 바꾼다)
if n > 2000000 :
    if image_type != ".gif" :
        imgResize(file_name)
        #print("줄인 용량")
        #print(n2)
    else :
        img = Image.open("temp.gif")
        img.save("temp.png",'png', optimize=True, quality=70)

        #png로 바꿔도 2mb 이상인 경우 이미지 사이즈 줄이기        
        n = os.path.getsize("temp.png")  # 이미지의 용량
        if n > 2000000 :
        imgResize(file_name)
